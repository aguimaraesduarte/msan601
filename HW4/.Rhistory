?combn
combn(5,1)
combn(5,2)
setwd("~/Documents/msan601/HW4")
df <- read.table("../bodyFat.txt", header=T)
df <- df[,getOrder(4,4)]
y <- df[,1] # extract the response variable
getOrder <- function(numCol, yColIndex){
return(c(yColIndex, 1:(yColIndex-1), (yColIndex+1):numCol))
}
getOrder <- function(numCol, yColIndex){
if(yColIndex < numCol) return(c(yColIndex, 1:(yColIndex-1), (yColIndex+1):numCol))
return(yColIndex, 1:(yColIndex-1))
}
getOrder(4,4)
getOrder <- function(numCol, yColIndex){
if(yColIndex < numCol) return(c(yColIndex, 1:(yColIndex-1), (yColIndex+1):numCol))
return(c(yColIndex, 1:(yColIndex-1)))
}
getOrder(4,4)
getOrder(6,4)
df <- df[,getOrder(4,4)]
y <- df[,1] # extract the response variable
df <- df[-1] # remove response from df
n <- nrow(df)
p <- ncol(df)
for(i in 1:p){
print(combn(p,i))
}
for(i in 1:p){
print(nrow(combn(p,i)))
}
for(i in 1:p-1){
print(nrow(combn(p,i)))
}
for(i in 1:(p-1){
for(i in 1:(p-1)){
print(nrow(combn(p,i)))
}
for(i in 1:(p-1)){
print((combn(p,i)))
}
rateprof <- alr4::Rateprof
rateprof <- as.data.frame(rateprof[!sapply(rateprof, is.factor)]) #remove factor columns
rateprof <- getOrder(13, 4)
rateprof <- alr4::Rateprof
rateprof <- as.data.frame(rateprof[!sapply(rateprof, is.factor)])
rateprof <- rateprof[,getOrder(13, 4)]
df <- rateprof
y <- df[,1] # extract the response variable
df <- df[-1] # remove response from df
n <- nrow(df)
p <- ncol(df)
for(i in 1:(p-1)){
print((combn(p,i)))
}
df <- rateprof[,1:6]
y <- df[,1] # extract the response variable
df <- df[-1] # remove response from df
n <- nrow(df)
p <- ncol(df)
for(i in 1:(p-1)){
print((combn(p,i)))
}
for(i in 1:(p-1)){
print((combn(p,i)))
lm_basic <- lm(y~df[,i])
R2 <- summary(lm_basic)$r.squared
cat(paste("R2 (", i, "): ", round(R2, 3), "\n", sep = ""))
}
for(i in 1:p){
print((combn(p-1,i)))
lm_basic <- lm(y~df[,i])
R2 <- summary(lm_basic)$r.squared
cat(paste("R2 (", i, "): ", round(R2, 3), "\n", sep = ""))
}
for(i in 1:p){
print((combn(p,i)))
lm_basic <- lm(y~df[,i])
R2 <- summary(lm_basic)$r.squared
cat(paste("R2 (", i, "): ", round(R2, 3), "\n", sep = ""))
}
comb(5,3)
combn(5,3)
combn(5,3)[2,6]
combn(5,3)[,1]
df[,combn(5,3)[,1]]
combn(5,1)
for(i in 1:p){
lm_basic <- lm(y~df[,i])
R2 <- summary(lm_basic)$r.squared
cat(paste("R2 (", i, "): ", round(R2, 3), "\n", sep = ""))
if(p < 2) break
for(j in 1:p){
if(i==j) next
lm_full <- lm(y~df[,i]+df[,j])
SSE_full <- tail(anova(lm_full)$"Sum Sq", 1)
lm_given <- lm(y~df[,j])
SSE_given <- tail(anova(lm_given)$"Sum Sq", 1)
R2 <- (SSE_given - SSE_full) / SSE_given
cat(paste("R2 (", i, " given ", j, "): ", round(R2, 3), "\n", sep = ""))
if(p < 3) break
for(k in j:p){
if(i==k | j==k) next
lm_full <- lm(y~df[,i]+df[,j]+df[,k])
SSE_full <- tail(anova(lm_full)$"Sum Sq", 1)
lm_given <- lm(y~df[,j]+df[,k])
SSE_given <- tail(anova(lm_given)$"Sum Sq", 1)
R2 <- (SSE_given - SSE_full) / SSE_given
cat(paste("R2 (", i, " given ", j, ", ", k, "): ", round(R2, 3), "\n", sep = ""))
if(p < 4) break
for(l in k:p){
if(i==l | j==l | k==l) next
lm_full <- lm(y~df[,i]+df[,j]+df[,k]+df[,l])
SSE_full <- tail(anova(lm_full)$"Sum Sq", 1)
lm_given <- lm(y~df[,j]+df[,k]+df[,l])
SSE_given <- tail(anova(lm_given)$"Sum Sq", 1)
R2 <- (SSE_given - SSE_full) / SSE_given
cat(paste("R2 (", i, " given ", j, ", ", k, ", ", l, "): ", round(R2, 3), "\n", sep = ""))
if(p < 5) break
for(m in l:p){
if(i==m | j==m | k==m | l==m) next
lm_full <- lm(y~df[,i]+df[,j]+df[,k]+df[,l]+df[,m])
SSE_full <- tail(anova(lm_full)$"Sum Sq", 1)
lm_given <- lm(y~df[,j]+df[,k]+df[,l]+df[,m])
SSE_given <- tail(anova(lm_given)$"Sum Sq", 1)
R2 <- (SSE_given - SSE_full) / SSE_given
cat(paste("R2 (", i, " given ", j, ", ", k, ", ", l, "): ", round(R2, 3), "\n", sep = ""))
if(p < 6) break
for(n in m:p){
if(i==n | j==n | k==n | l==n | m==n) next
lm_full <- lm(y~df[,i]+df[,j]+df[,k]+df[,l]+df[,m]+df[,n])
SSE_full <- tail(anova(lm_full)$"Sum Sq", 1)
lm_given <- lm(y~df[,j]+df[,k]+df[,l]+df[,m]+df[,n])
SSE_given <- tail(anova(lm_given)$"Sum Sq", 1)
R2 <- (SSE_given - SSE_full) / SSE_given
cat(paste("R2 (", i, " given ", j, ", ", k, ", ", l, "): ", round(R2, 3), "\n", sep = ""))
}
for(i in 1:p){
lm_basic <- lm(y~df[,i])
R2 <- summary(lm_basic)$r.squared
cat(paste("R2 (", i, "): ", round(R2, 3), "\n", sep = ""))
for(j in 1:p){
if(i==j) next
lm_full <- lm(y~df[,i]+df[,j])
SSE_full <- tail(anova(lm_full)$"Sum Sq", 1)
lm_given <- lm(y~df[,j])
SSE_given <- tail(anova(lm_given)$"Sum Sq", 1)
R2 <- (SSE_given - SSE_full) / SSE_given
cat(paste("R2 (", i, " given ", j, "): ", round(R2, 3), "\n", sep = ""))
for(k in j:p){
if(i==k | j==k) next
lm_full <- lm(y~df[,i]+df[,j]+df[,k])
SSE_full <- tail(anova(lm_full)$"Sum Sq", 1)
lm_given <- lm(y~df[,j]+df[,k])
SSE_given <- tail(anova(lm_given)$"Sum Sq", 1)
R2 <- (SSE_given - SSE_full) / SSE_given
cat(paste("R2 (", i, " given ", j, ", ", k, "): ", round(R2, 3), "\n", sep = ""))
for(l in k:p){
if(i==l | j==l | k==l) next
lm_full <- lm(y~df[,i]+df[,j]+df[,k]+df[,l])
SSE_full <- tail(anova(lm_full)$"Sum Sq", 1)
lm_given <- lm(y~df[,j]+df[,k]+df[,l])
SSE_given <- tail(anova(lm_given)$"Sum Sq", 1)
R2 <- (SSE_given - SSE_full) / SSE_given
cat(paste("R2 (", i, " given ", j, ", ", k, ", ", l, "): ", round(R2, 3), "\n", sep = ""))
for(m in l:p){
if(i==m | j==m | k==m | l==m) next
lm_full <- lm(y~df[,i]+df[,j]+df[,k]+df[,l]+df[,m])
SSE_full <- tail(anova(lm_full)$"Sum Sq", 1)
lm_given <- lm(y~df[,j]+df[,k]+df[,l]+df[,m])
SSE_given <- tail(anova(lm_given)$"Sum Sq", 1)
R2 <- (SSE_given - SSE_full) / SSE_given
cat(paste("R2 (", i, " given ", j, ", ", k, ", ", l, "): ", round(R2, 3), "\n", sep = ""))
for(n in m:p){
if(i==n | j==n | k==n | l==n | m==n) next
lm_full <- lm(y~df[,i]+df[,j]+df[,k]+df[,l]+df[,m]+df[,n])
SSE_full <- tail(anova(lm_full)$"Sum Sq", 1)
lm_given <- lm(y~df[,j]+df[,k]+df[,l]+df[,m]+df[,n])
SSE_given <- tail(anova(lm_given)$"Sum Sq", 1)
R2 <- (SSE_given - SSE_full) / SSE_given
cat(paste("R2 (", i, " given ", j, ", ", k, ", ", l, "): ", round(R2, 3), "\n", sep = ""))
}
for(i in 1:p){
lm_basic <- lm(y~df[,i])
R2 <- summary(lm_basic)$r.squared
cat(paste("R2 (", i, "): ", round(R2, 3), "\n", sep = ""))
for(j in 1:p){
if(i==j) next
lm_full <- lm(y~df[,i]+df[,j])
SSE_full <- tail(anova(lm_full)$"Sum Sq", 1)
lm_given <- lm(y~df[,j])
SSE_given <- tail(anova(lm_given)$"Sum Sq", 1)
R2 <- (SSE_given - SSE_full) / SSE_given
cat(paste("R2 (", i, " given ", j, "): ", round(R2, 3), "\n", sep = ""))
for(k in j:p){
if(i==k | j==k) next
lm_full <- lm(y~df[,i]+df[,j]+df[,k])
SSE_full <- tail(anova(lm_full)$"Sum Sq", 1)
lm_given <- lm(y~df[,j]+df[,k])
SSE_given <- tail(anova(lm_given)$"Sum Sq", 1)
R2 <- (SSE_given - SSE_full) / SSE_given
cat(paste("R2 (", i, " given ", j, ", ", k, "): ", round(R2, 3), "\n", sep = ""))
for(l in k:p){
if(i==l | j==l | k==l) next
lm_full <- lm(y~df[,i]+df[,j]+df[,k]+df[,l])
SSE_full <- tail(anova(lm_full)$"Sum Sq", 1)
lm_given <- lm(y~df[,j]+df[,k]+df[,l])
SSE_given <- tail(anova(lm_given)$"Sum Sq", 1)
R2 <- (SSE_given - SSE_full) / SSE_given
cat(paste("R2 (", i, " given ", j, ", ", k, ", ", l, "): ", round(R2, 3), "\n", sep = ""))
for(m in l:p){
if(i==m | j==m | k==m | l==m) next
lm_full <- lm(y~df[,i]+df[,j]+df[,k]+df[,l]+df[,m])
SSE_full <- tail(anova(lm_full)$"Sum Sq", 1)
lm_given <- lm(y~df[,j]+df[,k]+df[,l]+df[,m])
SSE_given <- tail(anova(lm_given)$"Sum Sq", 1)
R2 <- (SSE_given - SSE_full) / SSE_given
cat(paste("R2 (", i, " given ", j, ", ", k, ", ", l, "): ", round(R2, 3), "\n", sep = ""))
}
for(i in 1:p){
lm_basic <- lm(y~df[,i])
R2 <- summary(lm_basic)$r.squared
cat(paste("R2 (", i, "): ", round(R2, 3), "\n", sep = ""))
for(j in 1:p){
if(i==j) next
lm_full <- lm(y~df[,i]+df[,j])
SSE_full <- tail(anova(lm_full)$"Sum Sq", 1)
lm_given <- lm(y~df[,j])
SSE_given <- tail(anova(lm_given)$"Sum Sq", 1)
R2 <- (SSE_given - SSE_full) / SSE_given
cat(paste("R2 (", i, " given ", j, "): ", round(R2, 3), "\n", sep = ""))
for(k in j:p){
if(i==k | j==k) next
lm_full <- lm(y~df[,i]+df[,j]+df[,k])
SSE_full <- tail(anova(lm_full)$"Sum Sq", 1)
lm_given <- lm(y~df[,j]+df[,k])
SSE_given <- tail(anova(lm_given)$"Sum Sq", 1)
R2 <- (SSE_given - SSE_full) / SSE_given
cat(paste("R2 (", i, " given ", j, ", ", k, "): ", round(R2, 3), "\n", sep = ""))
for(l in k:p){
if(i==l | j==l | k==l) next
lm_full <- lm(y~df[,i]+df[,j]+df[,k]+df[,l])
SSE_full <- tail(anova(lm_full)$"Sum Sq", 1)
lm_given <- lm(y~df[,j]+df[,k]+df[,l])
SSE_given <- tail(anova(lm_given)$"Sum Sq", 1)
R2 <- (SSE_given - SSE_full) / SSE_given
cat(paste("R2 (", i, " given ", j, ", ", k, ", ", l, "): ", round(R2, 3), "\n", sep = ""))
for(m in l:p){
if(i==m | j==m | k==m | l==m) next
lm_full <- lm(y~df[,i]+df[,j]+df[,k]+df[,l]+df[,m])
SSE_full <- tail(anova(lm_full)$"Sum Sq", 1)
lm_given <- lm(y~df[,j]+df[,k]+df[,l]+df[,m])
SSE_given <- tail(anova(lm_given)$"Sum Sq", 1)
R2 <- (SSE_given - SSE_full) / SSE_given
cat(paste("R2 (", i, " given ", j, ", ", k, ", ", l, ", ", m, "): ", round(R2, 3), "\n", sep = ""))
for(n in m:p){
if(i==n | j==n | k==n | l==n | m==n) next
lm_full <- lm(y~df[,i]+df[,j]+df[,k]+df[,l]+df[,m]+df[,n])
SSE_full <- tail(anova(lm_full)$"Sum Sq", 1)
lm_given <- lm(y~df[,j]+df[,k]+df[,l]+df[,m]+df[,n])
SSE_given <- tail(anova(lm_given)$"Sum Sq", 1)
R2 <- (SSE_given - SSE_full) / SSE_given
cat(paste("R2 (", i, " given ", j, ", ", k, ", ", l, ", ", m, ", ", n, "): ", round(R2, 3), "\n", sep = ""))
for(o in n:p){
if(i==o | j==o | k==o | l==o | m==o | n==o) next
lm_full <- lm(y~df[,i]+df[,j]+df[,k]+df[,l]+df[,m]+df[,n]+df[,o])
SSE_full <- tail(anova(lm_full)$"Sum Sq", 1)
lm_given <- lm(y~df[,j]+df[,k]+df[,l]+df[,m]+df[,n]+df[,o])
SSE_given <- tail(anova(lm_given)$"Sum Sq", 1)
R2 <- (SSE_given - SSE_full) / SSE_given
cat(paste("R2 (", i, " given ", j, ", ", k, ", ", l, ", ", m, ", ", n, ", ", o, "): ", round(R2, 3), "\n", sep = ""))
}
rateprof <- alr4::Rateprof
rateprof <- as.data.frame(rateprof[!sapply(rateprof, is.factor)])
rateprof <- rateprof[,getOrder(13, 4)]
df <- rateprof[,1:6]
y <- df[,1] # extract the response variable
df <- df[-1] # remove response from df
n <- nrow(df)
p <- ncol(df)
for(i in 1:p){
lm_basic <- lm(y~df[,i])
R2 <- summary(lm_basic)$r.squared
cat(paste("R2 (", i, "): ", round(R2, 3), "\n", sep = ""))
for(j in 1:p){
if(i==j) next
lm_full <- lm(y~df[,i]+df[,j])
SSE_full <- tail(anova(lm_full)$"Sum Sq", 1)
lm_given <- lm(y~df[,j])
SSE_given <- tail(anova(lm_given)$"Sum Sq", 1)
R2 <- (SSE_given - SSE_full) / SSE_given
cat(paste("R2 (", i, " given ", j, "): ", round(R2, 3), "\n", sep = ""))
for(k in j:p){
if(i==k | j==k) next
lm_full <- lm(y~df[,i]+df[,j]+df[,k])
SSE_full <- tail(anova(lm_full)$"Sum Sq", 1)
lm_given <- lm(y~df[,j]+df[,k])
SSE_given <- tail(anova(lm_given)$"Sum Sq", 1)
R2 <- (SSE_given - SSE_full) / SSE_given
cat(paste("R2 (", i, " given ", j, ", ", k, "): ", round(R2, 3), "\n", sep = ""))
for(l in k:p){
if(i==l | j==l | k==l) next
lm_full <- lm(y~df[,i]+df[,j]+df[,k]+df[,l])
SSE_full <- tail(anova(lm_full)$"Sum Sq", 1)
lm_given <- lm(y~df[,j]+df[,k]+df[,l])
SSE_given <- tail(anova(lm_given)$"Sum Sq", 1)
R2 <- (SSE_given - SSE_full) / SSE_given
cat(paste("R2 (", i, " given ", j, ", ", k, ", ", l, "): ", round(R2, 3), "\n", sep = ""))
for(m in l:p){
if(i==m | j==m | k==m | l==m) next
lm_full <- lm(y~df[,i]+df[,j]+df[,k]+df[,l]+df[,m])
SSE_full <- tail(anova(lm_full)$"Sum Sq", 1)
lm_given <- lm(y~df[,j]+df[,k]+df[,l]+df[,m])
SSE_given <- tail(anova(lm_given)$"Sum Sq", 1)
R2 <- (SSE_given - SSE_full) / SSE_given
cat(paste("R2 (", i, " given ", j, ", ", k, ", ", l, ", ", m, "): ", round(R2, 3), "\n", sep = ""))
for(n in m:p){
if(i==n | j==n | k==n | l==n | m==n) next
lm_full <- lm(y~df[,i]+df[,j]+df[,k]+df[,l]+df[,m]+df[,n])
SSE_full <- tail(anova(lm_full)$"Sum Sq", 1)
lm_given <- lm(y~df[,j]+df[,k]+df[,l]+df[,m]+df[,n])
SSE_given <- tail(anova(lm_given)$"Sum Sq", 1)
R2 <- (SSE_given - SSE_full) / SSE_given
cat(paste("R2 (", i, " given ", j, ", ", k, ", ", l, ", ", m, ", ", n, "): ", round(R2, 3), "\n", sep = ""))
for(o in n:p){
if(i==o | j==o | k==o | l==o | m==o | n==o) next
lm_full <- lm(y~df[,i]+df[,j]+df[,k]+df[,l]+df[,m]+df[,n]+df[,o])
SSE_full <- tail(anova(lm_full)$"Sum Sq", 1)
lm_given <- lm(y~df[,j]+df[,k]+df[,l]+df[,m]+df[,n]+df[,o])
SSE_given <- tail(anova(lm_given)$"Sum Sq", 1)
R2 <- (SSE_given - SSE_full) / SSE_given
cat(paste("R2 (", i, " given ", j, ", ", k, ", ", l, ", ", m, ", ", n, ", ", o, "): ", round(R2, 3), "\n", sep = ""))
}
rateprof <- alr4::Rateprof
rateprof <- as.data.frame(rateprof[!sapply(rateprof, is.factor)])
rateprof <- rateprof[,getOrder(13, 4)]
df <- rateprof
y <- df[,1] # extract the response variable
df <- df[-1] # remove response from df
n <- nrow(df)
p <- ncol(df)
for(i in 1:p){
lm_basic <- lm(y~df[,i])
R2 <- summary(lm_basic)$r.squared
cat(paste("R2 (", i, "): ", round(R2, 3), "\n", sep = ""))
for(j in 1:p){
if(i==j) next
lm_full <- lm(y~df[,i]+df[,j])
SSE_full <- tail(anova(lm_full)$"Sum Sq", 1)
lm_given <- lm(y~df[,j])
SSE_given <- tail(anova(lm_given)$"Sum Sq", 1)
R2 <- (SSE_given - SSE_full) / SSE_given
cat(paste("R2 (", i, " given ", j, "): ", round(R2, 3), "\n", sep = ""))
for(k in j:p){
if(i==k | j==k) next
lm_full <- lm(y~df[,i]+df[,j]+df[,k])
SSE_full <- tail(anova(lm_full)$"Sum Sq", 1)
lm_given <- lm(y~df[,j]+df[,k])
SSE_given <- tail(anova(lm_given)$"Sum Sq", 1)
R2 <- (SSE_given - SSE_full) / SSE_given
cat(paste("R2 (", i, " given ", j, ", ", k, "): ", round(R2, 3), "\n", sep = ""))
for(l in k:p){
if(i==l | j==l | k==l) next
lm_full <- lm(y~df[,i]+df[,j]+df[,k]+df[,l])
SSE_full <- tail(anova(lm_full)$"Sum Sq", 1)
lm_given <- lm(y~df[,j]+df[,k]+df[,l])
SSE_given <- tail(anova(lm_given)$"Sum Sq", 1)
R2 <- (SSE_given - SSE_full) / SSE_given
cat(paste("R2 (", i, " given ", j, ", ", k, ", ", l, "): ", round(R2, 3), "\n", sep = ""))
for(m in l:p){
if(i==m | j==m | k==m | l==m) next
lm_full <- lm(y~df[,i]+df[,j]+df[,k]+df[,l]+df[,m])
SSE_full <- tail(anova(lm_full)$"Sum Sq", 1)
lm_given <- lm(y~df[,j]+df[,k]+df[,l]+df[,m])
SSE_given <- tail(anova(lm_given)$"Sum Sq", 1)
R2 <- (SSE_given - SSE_full) / SSE_given
cat(paste("R2 (", i, " given ", j, ", ", k, ", ", l, ", ", m, "): ", round(R2, 3), "\n", sep = ""))
for(n in m:p){
if(i==n | j==n | k==n | l==n | m==n) next
lm_full <- lm(y~df[,i]+df[,j]+df[,k]+df[,l]+df[,m]+df[,n])
SSE_full <- tail(anova(lm_full)$"Sum Sq", 1)
lm_given <- lm(y~df[,j]+df[,k]+df[,l]+df[,m]+df[,n])
SSE_given <- tail(anova(lm_given)$"Sum Sq", 1)
R2 <- (SSE_given - SSE_full) / SSE_given
cat(paste("R2 (", i, " given ", j, ", ", k, ", ", l, ", ", m, ", ", n, "): ", round(R2, 3), "\n", sep = ""))
for(o in n:p){
if(i==o | j==o | k==o | l==o | m==o | n==o) next
lm_full <- lm(y~df[,i]+df[,j]+df[,k]+df[,l]+df[,m]+df[,n]+df[,o])
SSE_full <- tail(anova(lm_full)$"Sum Sq", 1)
lm_given <- lm(y~df[,j]+df[,k]+df[,l]+df[,m]+df[,n]+df[,o])
SSE_given <- tail(anova(lm_given)$"Sum Sq", 1)
R2 <- (SSE_given - SSE_full) / SSE_given
cat(paste("R2 (", i, " given ", j, ", ", k, ", ", l, ", ", m, ", ", n, ", ", o, "): ", round(R2, 3), "\n", sep = ""))
}
source("hw4q9.R")
